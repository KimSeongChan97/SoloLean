package board.service;

import java.util.HashMap;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import board.dao.BoardDAO;
import com.control.CommandProcess;

public class BoardUpdateService implements CommandProcess {

    @Override
    public String requestPro(HttpServletRequest request, HttpServletResponse response) throws Throwable {
        // 파라미터에서 게시글 정보 받아오기
        int seq = Integer.parseInt(request.getParameter("seq"));
        String subject = request.getParameter("subject");
        String content = request.getParameter("content");
        
        // 디버깅용
        System.out.println("Subject: " + subject);
        System.out.println("Content: " + content);
        
        // Null 또는 빈 값 처리
        if(subject == null || subject.trim().isEmpty()) {
            throw new IllegalArgumentException("제목을 입력해 주세요.");
        }
        if(content == null || content.trim().isEmpty()) {
            throw new IllegalArgumentException("내용을 입력해 주세요.");
        }
        
        // DB에서 게시글 수정
        BoardDAO boardDAO = BoardDAO.getInstance();
        Map<String, String> map = new HashMap<>();
        map.put("seq", String.valueOf(seq));
        map.put("subject", subject);
        map.put("content", content);
        
        boardDAO.updateBoard(map);

        // 수정 후 해당 게시글 보기 페이지로 리다이렉트
        return "/board/boardView.do?seq=" + seq;
    }
}
