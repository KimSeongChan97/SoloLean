package user.service;

import java.util.Scanner; // 사용자 입력을 받기 위해 Scanner 클래스를 사용

import user.dao.UserDAO;  // 데이터베이스와 상호작용하기 위해 UserDAO 클래스를 사용
import user.main.UserMain; // 입력된 아이디가 없을 때 메인 메뉴로 돌아가기 위해 UserMain 클래스를 사용
import user.bean.UserDTO;  // 사용자 정보를 담고 있는 UserDTO 클래스를 사용

public class UserUpdateService implements UserService {

    @Override
    public void execute() {
    	System.out.println(); // 가독성을 위한 빈 줄 출력
    	
    	Scanner scan = new Scanner(System.in); // 사용자 입력을 받기 위한 Scanner 객체 생성
    	
    	// DB와 상호작용하기 위한 UserDAO 객체를 싱글톤 패턴으로 가져옴
    	UserDAO userDAO = UserDAO.getInstance(); 
    	
    	// 사용자로부터 수정할 아이디를 입력받음
    	System.out.print("수정할 아이디 입력 : ");
    	String id = scan.next();  // 아이디 입력받기
    	
    	// 입력된 아이디에 해당하는 사용자를 DB에서 조회
        UserDTO userDTO = userDAO.getUser(id);
    	
        // 만약 해당 ID의 사용자가 없을 경우 처리
        if (userDTO == null) { 
        	System.err.println();
        	System.out.println("--------ERROR !--------");
            System.out.println("해당 아이디가 존재하지 않습니다."); 
            // 사용자가 없을 경우 메인 메뉴로 돌아가도록 UserMain.main(null) 호출
            UserMain.main(null); 
            return; // 메소드를 종료하여 더 이상 진행되지 않도록 함
        }
            	  
    	// 수정할 사용자 정보를 입력받음 (이름과 비밀번호)
    	System.out.print("수정할 이름 입력 : ");
    	String name = scan.next(); // 수정할 이름 입력받기
    	
    	System.out.print("수정할 비밀번호 입력 : ");
    	String pwd = scan.next(); // 수정할 비밀번호 입력받기
    	
    	// 입력받은 새로운 정보를 UserDTO 객체에 설정
    	userDTO.setName(name); // 새로운 이름으로 설정
    	userDTO.setPwd(pwd);   // 새로운 비밀번호로 설정
    	
    	// DB에 수정된 사용자 정보를 반영 (업데이트)
    	int su = userDAO.updateUser(userDTO); // updateUser 메소드를 호출하여 DB 업데이트
    	
    	// 업데이트된 행의 개수를 출력
    	System.out.println(su + " 개의 행을 수정하였습니다."); // 몇 개의 행이 수정되었는지 출력

    }
}
