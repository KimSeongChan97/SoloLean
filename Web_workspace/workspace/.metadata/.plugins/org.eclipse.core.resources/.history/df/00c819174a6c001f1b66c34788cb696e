<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="board.dao.BoardDAO" %>
<%@ page import="board.bean.BoardDTO" %>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>게시글 보기</title>
    <link rel="stylesheet" type="text/css" href="/projectJSP/css/boardView.css">
</head>
<body>

    <jsp:include page="/jsp/nav.jsp" />

    <h2 align="center" style="font-family: 'Comic Sans MS';"  
    	onclick="location.href='../index.jsp'" > N o t e _ V i e w </h2>

     <%
        // 게시글 정보를 가져오는 로직
        int seq = Integer.parseInt(request.getParameter("seq"));
        BoardDAO boardDAO = BoardDAO.getInstance();
        
        // 조회수 증가
        boardDAO.increaseHit(seq); 
        
        // 게시글 조회
        BoardDTO board = boardDAO.getBoard(seq);
    %>

    <div class="post-info">
        <label>제목:</label>
        <div class="title"><%= boardDTO.getSubject() %></div>
        
        <label>내용:</label>
        <div class="content"><%= boardDTO.getContent() %></div>
        
        <label>작성자:</label>
        <div class="author"><%= boardDTO.getName() %></div>
        
        <label>작성자 email:</label>
        <div class="email"><%= boardDTO.getEmail() %></div>
        
        <label>작성일:</label>
        <div class="date"><%= boardDTO.getLogtime() %></div>
        
        <label>조회수:</label>
        <div class="views"><%= boardDTO.getHit() %></div>
    </div>

    <!-- 댓글 입력 폼 -->
    <div class="comment-section">
        <h3>댓글 달기</h3>
        <form action="addComment.jsp" method="post">
            <input type="hidden" name="boardSeq" value="<%= boardDTO.getSeq() %>">
            <textarea name="comment" placeholder="댓글을 입력하세요"></textarea>
            <input type="submit" value="댓글 달기">
        </form>
    </div>

    <!-- 댓글 리스트 -->
    <div class="comments-list">
        <h3>댓글 목록</h3>
        <ul>
            <% 
            List<CommentDTO> commentList = commentDAO.getCommentsByBoardSeq(boardDTO.getSeq());
            for (CommentDTO comment : commentList) {
            %>
            <li>
                <strong><%= comment.getWriter() %></strong>: <%= comment.getContent() %> 
                <span>(<%= comment.getWriteTime() %>)</span>
            </li>
            <% } %>
        </ul>
    </div>

    <!-- 목록으로 돌아가기 버튼 -->
    <div class="back-button">
        <button onclick="location.href='boardList.jsp'">목록으로</button>
    </div>
</div>

    <script type="text/javascript" src="http://code.jquery.com/jquery-3.7.1.min.js"></script>
</body>
</html>
