<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="userSQL">
    <!-- MyBatis 매퍼 파일입니다. 이 파일은 SQL 쿼리를 정의하고 Java 코드와 매핑하는 역할을 합니다.
         namespace="userSQL": 이 매퍼 파일이 사용하는 네임스페이스를 'userSQL'로 지정합니다.
         네임스페이스는 여러 매퍼 파일에서 같은 SQL ID를 사용하지 않도록 구분하는 역할을 합니다. -->
    
    <!-- 만약에 테이블의 컬럼과 객체의 필드명이 다른 경우 -->
    <resultMap type="user.bean.UserDTO" id="userResult">
        <!-- resultMap 태그는 테이블의 컬럼 이름과 객체의 필드 이름이 다를 때 매핑을 정의하는 데 사용됩니다.
             여기서 userResult라는 이름의 resultMap을 정의하고, usertable 테이블의 NAME, ID, PWD 컬럼을 각각 UserDTO 객체의 name, id, pwd 필드와 매핑합니다. -->
        <result column="NAME" property="name" />
        <!-- column="NAME": 테이블의 'NAME' 컬럼을,
             property="name": UserDTO 객체의 'name' 필드에 매핑 -->
        <result column="ID" property="id" />
        <!-- column="ID": 테이블의 'ID' 컬럼을,
             property="id": UserDTO 객체의 'id' 필드에 매핑 -->
        <result column="PWD" property="pwd" />
        <!-- column="PWD": 테이블의 'PWD' 컬럼을,
             property="pwd": UserDTO 객체의 'pwd' 필드에 매핑 -->
    </resultMap>
    
    <!-- 이름으로 구분 -->
    <!-- insert 태그: 데이터베이스에 새로운 데이터를 삽입하는 SQL 쿼리를 정의합니다. -->
    <insert id="write" parameterType="user">
        <!-- id="write": 이 insert 쿼리의 고유 식별자입니다. MyBatis는 이 식별자를 통해 Java 코드에서 이 SQL을 호출할 수 있습니다.
             parameterType="user.bean.UserDTO": 이 쿼리에 전달될 파라미터 타입을 지정합니다. 'user.bean.UserDTO'는 Java 클래스이며, 이 클래스의 인스턴스가 파라미터로 전달됩니다.
             이 클래스에는 'name', 'id', 'pwd' 같은 필드가 있을 것이며, 이 필드들이 SQL 쿼리에 맵핑됩니다. -->

        <!-- insert into usertable values(?, ?, ?) -->
        <!-- 주석에서 설명하는 바와 같이, 실제로는 '?' 자리에 파라미터 값이 들어가게 됩니다.
             MyBatis는 '#{필드명}'을 통해 Java 객체의 필드 값을 SQL 쿼리에 바인딩합니다. -->

        insert into usertable values(#{name}, #{id}, #{pwd})
        <!-- SQL 쿼리: 'usertable'이라는 테이블에 데이터를 삽입하는 쿼리입니다.
             #{name}, #{id}, #{pwd}는 MyBatis의 바인딩 표현식입니다. 
             - #{name}: UserDTO 객체의 'name' 필드 값을 가져와 이 자리에 삽입합니다.
             - #{id}: UserDTO 객체의 'id' 필드 값을 가져옵니다.
             - #{pwd}: UserDTO 객체의 'pwd' 필드 값을 가져옵니다.
             이를 통해 Java 코드에서 전달된 객체의 필드 값을 쿼리에 반영할 수 있습니다.
             SQL 주입 공격을 방지하기 위해 MyBatis는 자동으로 이 값을 적절히 처리해 줍니다. -->
    </insert>
    
    <!-- select 태그: DB에서 데이터를 조회하는 SQL 쿼리를 정의합니다. -->
    <select id="getAllList" resultMap="userResult">
        <!-- id="getAllList": 이 select 쿼리의 고유 식별자입니다. MyBatis는 이 식별자를 통해 Java 코드에서 이 SQL을 호출할 수 있습니다.
             resultMap="userResult": 이 쿼리의 결과를 'userResult'라는 resultMap을 통해 UserDTO 객체에 매핑합니다.
             resultMap은 각 컬럼과 객체의 필드를 매핑하기 위한 규칙을 정의하는데, 위에서 정의한 'userResult'를 사용합니다. -->

        select * from usertable
        <!-- SQL 쿼리: 'usertable'에서 모든 데이터를 선택하여 조회하는 쿼리입니다.
             '*'는 테이블의 모든 열을 의미하며, 결과는 각 행이 UserDTO 객체로 매핑됩니다.
             이 쿼리는 usertable에 저장된 모든 사용자 정보를 반환하게 됩니다. -->
    </select>
    
    <!-- 특정 사용자를 ID로 조회하는 쿼리 -->
    <select id="getUser" parameterType="String" resultMap="userResult">
        <!-- id="getUser": 이 select 쿼리의 고유 식별자입니다. 'getUser'라는 이름으로 이 SQL 쿼리를 호출할 수 있습니다.
             parameterType="String": 이 쿼리에 전달될 파라미터의 타입을 지정합니다. 이 경우, ID를 조회할 것이므로 String 타입입니다.
             resultMap="userResult": 조회된 결과를 'userResult'로 정의된 매핑 규칙에 따라 UserDTO 객체로 변환합니다. -->

        select * from usertable where id = #{id}
        <!-- SQL 쿼리: 'usertable'에서 특정 id를 가진 사용자의 데이터를 선택하는 쿼리입니다.
             #{id}는 MyBatis에서 파라미터로 전달된 값을 바인딩하는 표현식입니다. -->
    </select>
    
    <!-- 사용자 정보를 업데이트하는 쿼리 -->
    <update id="updateUser" parameterType="user">
        <!-- id="updateUser": 이 update 쿼리의 고유 식별자입니다. 'updateUser'라는 이름으로 이 SQL 쿼리를 호출할 수 있습니다.
             parameterType="user.bean.UserDTO": 이 쿼리에 전달될 파라미터의 타입을 지정합니다. 'user'는 UserDTO 객체를 참조합니다. -->

        update usertable
        set name = #{name}, pwd = #{pwd}
        where id = #{id}
        <!-- SQL 쿼리: 'usertable'에서 특정 id를 가진 사용자의 이름(name)과 비밀번호(pwd)를 업데이트하는 쿼리입니다.
             #{name}, #{pwd}, #{id}는 MyBatis가 UserDTO 객체에서 가져온 값을 바인딩합니다. -->
    </update>
    
    <!-- 삭제 -->
    <delete id="deleteUser" parameterType="String" >
    	delete from usertable where id = #{id}
    </delete>
    
    
</mapper>

