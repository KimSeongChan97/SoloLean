<!DOCTYPE html> 
<html lang="en"> 
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<title>Document</title>
<link rel="stylesheet" href="../css/common.css"> 
<link rel="stylesheet" href="../css/reset.css">
</head> 
<body>
<h1 class="title">동적 드롭다운</h1> 
<div class="exec">
<form>
<!-- 각 단계별 dropdown을 표시할 span태그 --> 
<span id="category1"></span> <!-- 1depth 카테고리가 로드될 위치 -->
<span id="category2"></span> <!-- 2depth 카테고리가 로드될 위치 -->
<span id="category3"></span> <!-- 3depth 카테고리가 로드될 위치 -->

<!-- 1depth 카테고리 -->
<select name="category1" id="category1-1">
  <option>----- 선택하세요 -----</option>
  <option value="의류" data-target="#category2-1">의류</option> <!-- 의류 선택 시 2depth인 의류 관련 카테고리 로드 -->
  <option value="디지털/가전" data-target="#category2-2">디지털/가전</option> <!-- 디지털/가전 선택 시 관련 카테고리 로드 -->
</select>

<!-- 의류에 종속된 2depth 카테고리 -->
<select name="category2" id="category2-1">
  <option>----- 선택하세요 -----</option>
  <option value="여성의류" data-target="#category2-1-1">여성의류</option> <!-- 여성의류 선택 시 3depth 로드 -->
  <option value="남성의류/캐주얼의류" data-target="#category2-1-2">남성의류/캐주얼의류</option> <!-- 남성의류 선택 시 3depth 로드 -->
</select>

<!-- 디지털/가전 2depth 카테고리 -->
<select name="category2" id="category2-2">
  <option>----- 선택하세요 -----</option>
  <option value="TV/냉장고/세탁기" data-target="#category2-2-1">TV/냉장고/세탁기</option> <!-- TV/냉장고 선택 시 관련 3depth 로드 -->
  <option value="노트북/데스크탑" data-target="#category2-2-2">노트북/데스크탑</option> <!-- 노트북 선택 시 관련 3depth 로드 -->
</select>

<!-- 의류 > 여성의류에 종속된 3depth 카테고리 -->
<select name="category3" id="category2-1-1">
  <option>----- 선택하세요 -----</option>
  <option value="티셔츠">티셔츠</option> <!-- 3depth 최종 선택 항목 -->
  <option value="블라우스/셔츠/남방">블라우스/셔츠/남방</option>
  <option value="가디건">가디건</option>
  <option value="니트/스웨터">니트/스웨터</option>
</select>

<!-- 의류 > 남성의류/캐주얼의류에 종속된 3depth 카테고리 -->
<select name="category3" id="category2-1-2">
  <option>----- 선택하세요 -----</option>
  <option value="캐주얼셔츠/남방">캐주얼셔츠/남방</option>
  <option value="긴팔티/맨투맨신규코너">긴팔티/맨투맨신규코너</option>
  <option value="청바지인기코너">청바지인기코너</option>
  <option value="캐주얼 바지/팬츠">캐주얼 바지/팬츠</option>
</select>

<!-- 디지털/가전 > TV/냉장고/세탁기에 종속된 3depth 카테고리 -->
<select name="category3" id="category2-2-1">
  <option>----- 선택하세요 -----</option>
  <option value="3D TV">3D TV</option>
  <option value="김치냉장고">김치냉장고</option>
  <option value="드럼세탁기">드럼세탁기</option>
</select>

<!-- 디지털/가전 > 노트북/데스크탑에 종속된 3depth 카테고리 -->
<select name="category3" id="category2-2-2">
  <option>----- 선택하세요 -----</option>
  <option value="노트북">노트북</option>
  <option value="브랜드PC">브랜드PC</option>
  <option value="조립PC">조립PC</option>
</select>

</form> 
</div>
<div class="console"></div> <!-- 사용자가 선택한 카테고리 경로를 표시하는 콘솔 -->
<script src="http://code.jQuery.com/jquery-3.7.1.min.js"></script> 
<script>
$(function(){ 
//1 depth
$('#category1').load('../text/category-data.html #category1-1',function(){ 
  // 1depth 카테고리 데이터를 비동기적으로 서버에서 불러옴
  // 비동기적으로 category-data.html에서 id가 #category1-1인 부분을 불러와서 현재 DOM의 #category1에 삽입
  $(this).show();
});
//2 depth
$(document).on('change', '#category1 > select', function(){ 
  // 1depth에서 선택을 변경할 때 발생하는 이벤트
  $('#category2, .console').empty(); // 2depth와 콘솔 내용을 초기화
  $('#category3').empty(); // 3depth를 초기화
  var target = $(this).find('option:selected').attr('data-target'); 
  // 사용자가 선택한 1depth의 data-target 속성 값을 가져옴 (예: #category2-1, #category2-2 등)
  console.log('target = ' + target);
  $('#category2').load('../text/category-data.html ' + target, function(){ 
    // 선택한 카테고리에 따라 2depth 카테고리를 로드
    $(this).show();
  }); 
});
//3 depth
$(document).on('change', '#category2 > select', function(){
  // 2depth에서 선택을 변경할 때 발생하는 이벤트
  $('#category3, .console').empty(); // 3depth와 콘솔 내용을 초기화
  var target = $(this).find('option:selected').attr('data-target'); 
  // 사용자가 선택한 2depth의 data-target 속성 값을 가져옴 (예: #category2-1-1, #category2-2-1 등)
  console.log('target = ' + target);
  $('#category3').load('../text/category-data.html ' + target, function(){ 
    // 선택한 2depth 카테고리에 따라 3depth 카테고리를 로드
    $(this).show();
  });
});
//마지막 선택
$(document).on('change', '#category3 > select', function(){ 
  // 3depth에서 선택을 변경할 때 발생하는 이벤트
  if($(this).find('option:selected').index() > 0) { 
    // 선택된 옵션의 인덱스가 0보다 클 때, 즉 '----- 선택하세요 -----' 옵션이 아닌 경우에 실행
    var data1 = $('#category1 > select > option:selected').val(); 
    // 선택된 1depth 카테고리의 값을 가져옴
    var data2 = $('#category2 > select > option:selected').val(); 
    // 선택된 2depth 카테고리의 값을 가져옴
    var data3 = $('#category3 > select > option:selected').val(); 
    // 선택된 3depth 카테고리의 값을 가져옴
    $('.console').html(data1 + ' &gt; ' + data2 + ' &gt; ' + data3);
    // 콘솔 영역에 선택된 경로를 출력함 ('의류 > 여성의류 > 티셔츠'와 같은 형식으로 출력)
  } 
});
}); 
</script>
</body> 
</html>
