<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="imageboardSQL">
  
  <!-- 이미지 업로드 -->
  <insert id="imageboardWrite" parameterType="imageboard">
    <!-- Oracle -->
    <!-- INSERT INTO imageboard VALUES(seq_imageboard.nextval
    								, #{imageId}
    								, #{imageName}
    								, #{imagePrice}
    								, #{imageQty}
    								, #{imageContent}
    								, #{image1}
    								, sysdate) -->
    
    <!-- MySQL -->
    INSERT INTO imageboard (imageId
    						, imageName
    						, imagePrice
    						, imageQty
    						, imageContent
    						, image1
    						, logtime)
				    		VALUES (#{imageId}
						    		, #{imageName}
						    		, #{imagePrice}
						    		, #{imageQty}
						    		, #{imageContent}
						    		, #{image1}
						    		, (current_date))
    <!-- logtime: MySQL에서는 날짜를 (current_date) 함수로 처리 -->
  </insert>
  
  <!-- 이미지 목록 조회 -->
  <select id="imageboardList" parameterType="java.util.Map" resultType="imageboard">
    <!-- Oracle -->
    <!-- <![CDATA[
    SELECT * FROM
    (SELECT ROWNUM rn, tt.* FROM
      (SELECT * FROM imageboard ORDER BY seq DESC) tt
    ) WHERE rn >= #{startNum} AND rn <= #{endNum}
    ]]> -->
    
    <!-- MySQL -->
    <![CDATA[
    SELECT * FROM imageboard 
    ORDER BY seq DESC 
    LIMIT #{startNum}, #{endNum}
    ]]>
  </select>

  <!-- 총 글 수 조회 -->
  <select id="getTotalA" resultType="int">
    <!-- Oracle -->
    <!-- select count(*) from imageboard -->
    
    <!-- MySQL -->
    select count(*) from imageboard
  </select>
	
  <!-- 선택한 이미지 삭제 -->
  <delete id="deleteSelected" parameterType="list">
    <!-- Oracle -->
    <!-- DELETE FROM imageboard WHERE seq IN
    <foreach item="seq" index="index" collection="list" open="(" separator="," close=")">
      #{seq}
    </foreach> -->
    
    <!-- MySQL -->
    DELETE FROM imageboard WHERE seq IN
    <foreach item="seq" index="index" collection="list" open="(" separator="," close=")">
      #{seq}
    </foreach>
  </delete>
  
</mapper>
